(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{"5e4e":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-layout",{staticClass:"myfont ",attrs:{view:"lHh Lpr lFf"}},[a("q-page-container",[a("q-page",[a("div",{staticClass:"row flex flex-center"},[a("div",{staticClass:"col-lg-12 col-md-12 col-sm-12 flex flex-center"},[a("span",{staticClass:"text-h4 text-bold q-my-md"},[t._v("SCAN QR")])]),!0===t.camera?a("div",{staticClass:"col-lg-12 col-md-12 col-sm-12 flex flex-center"},[a("StreamBarcodeReader",{staticStyle:{"max-width":"300px"},on:{decode:t.onDecode,loaded:t.onLoaded}})],1):t._e(),!0===t.scanned?a("div",{staticClass:"col-lg-12 col-md-12 col-sm-12 flex flex-center"},[a("span",{staticClass:"text-h6 q-my-md text-bold"},[t._v("Product Code: "+t._s(t.result))])]):t._e(),!0===t.scanned?a("q-separator"):t._e(),!0===t.addDetail?a("div",{staticClass:"q-my-md col-lg-12 col-md-12 col-sm-12 flex flex-center"},[a("q-btn",{attrs:{size:"20px",color:"primary"},on:{click:function(e){t.add_details=!0}}},[a("i",{staticClass:"fa fa-plus q-mr-md"}),a("div",[t._v(" Add Details")])])],1):t._e(),!0===t.addPurchase?a("div",{staticClass:"col-lg-12 col-md-12 col-sm-12 flex flex-center"},[a("q-item",{staticClass:"justify-left"},[a("q-item-section",[a("q-item-label",[a("span",{staticClass:"text-h4 text-bold text-info col-lg-12 col-md-12"},[t._v(" "+t._s(t.product_name))])]),a("q-item-label",[a("span",{staticClass:"q-py-none  text-h5 text-bold"},[t._v(" "+t._s(t.company_name))])]),a("q-item-label",[a("span",{staticClass:"text-h7 "},[t._v(" "+t._s(t.variant))])]),a("q-item-label",[a("span",{staticClass:"text-h6 text-info text-bold"},[t._v("Your Price: "+t._s(t.price)+" Php")])])],1)],1),a("q-btn",{attrs:{size:"20px",color:"info"},on:{click:function(e){return t.add_to_list()}}},[a("i",{staticClass:"fa fa-cart-plus q-mr-md"}),a("div",[t._v(" Add to Purchase")])])],1):t._e()],1),a("q-dialog",{attrs:{"transition-show":"rotate","transition-hide":"rotate"},model:{value:t.add_details,callback:function(e){t.add_details=e},expression:"add_details"}},[a("q-card",[a("q-card-section",{attrs:{align:"center"}},[a("div",{staticClass:"text-h6 text-bold"},[t._v("ADD PRODUCT")])]),a("q-card-section",{staticClass:"q-pt-none"},[a("span",{staticClass:"text-h6 text-bold"},[t._v("Product Code : "+t._s(t.result))]),a("q-separator",{attrs:{inset:""}})],1),a("q-card-section",{staticClass:"q-pt-none"},[a("p",{staticClass:"text-bold"},[t._v("Product Name")]),a("q-input",{ref:"product_name",attrs:{rules:[function(t){return!!t||"Required"}],outlined:"","bg-color":"white"},scopedSlots:t._u([{key:"prepend",fn:function(){},proxy:!0}]),model:{value:t.product_name,callback:function(e){t.product_name=e},expression:"product_name"}})],1),a("q-card-section",{staticClass:"q-pt-none"},[a("p",{staticClass:"text-bold"},[t._v("Company Name")]),a("q-input",{ref:"company_name",attrs:{rules:[function(t){return!!t||"Required"}],outlined:"","bg-color":"white"},scopedSlots:t._u([{key:"prepend",fn:function(){},proxy:!0}]),model:{value:t.company_name,callback:function(e){t.company_name=e},expression:"company_name"}})],1),a("q-card-section",{staticClass:"q-pt-none"},[a("p",{staticClass:"text-bold"},[t._v("Variant (Size, Color, Etc.)")]),a("q-input",{ref:"variant",attrs:{rules:[function(t){return!!t||"Required"}],outlined:"","bg-color":"white"},scopedSlots:t._u([{key:"prepend",fn:function(){},proxy:!0}]),model:{value:t.variant,callback:function(e){t.variant=e},expression:"variant"}})],1),a("q-card-section",{staticClass:"q-pt-none"},[a("p",{staticClass:"text-bold"},[t._v("Your Price")]),a("q-input",{ref:"price",attrs:{rules:[function(t){return!!t||"Required"}],outlined:"","bg-color":"white"},scopedSlots:t._u([{key:"prepend",fn:function(){},proxy:!0}]),model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1),a("q-card-actions",{attrs:{align:"center"}},[a("q-btn",{attrs:{size:"20px",label:"ADD PRODUCT",color:"info"},on:{click:function(e){return t.add_to_store()}}})],1)],1)],1),a("q-dialog",{attrs:{maximized:t.maximizedToggle,persistent:""},model:{value:t.purchased,callback:function(e){t.purchased=e},expression:"purchased"}},[a("div",{staticClass:" bg-white "},[a("q-card",{attrs:{flat:""}},[a("q-card-section",[a("i",{staticClass:"fas fa-window-close text-primary float-right",staticStyle:{"font-size":"18px"},on:{click:function(e){t.purchased=!1}}})]),a("q-card-section",[a("q-card-section",[a("div",{staticClass:"text-h6 text-center text-bold"},[t._v("NEW PURCHASE")])]),a("div",{},[t._v("Customer Phone #")]),a("q-input",{ref:"customer_no",attrs:{outlined:"",mask:"###########",rules:[function(t){return!!t||"Required"}]},model:{value:t.customer_no,callback:function(e){t.customer_no=e},expression:"customer_no"}})],1),a("q-card-section",{staticClass:"q-mb-sm"},[a("span",{staticClass:"text-bold float-left"},[t._v("Subtotal:")]),a("q-space"),a("span",{staticClass:"text-bold float-right"},[t._v("â‚±  "+t._s(t.formatPrice(t.subtotal)))])],1),a("q-separator"),a("q-card-section",[a("q-table",{attrs:{title:"Item List",data:t.products,columns:t.columns,"row-key":"product","binary-state-sort":""},scopedSlots:t._u([{key:"body",fn:function(e){return[a("q-tr",{attrs:{props:e}},[a("q-td",{key:"quantity",attrs:{props:e}},[t._v("\n            "+t._s(e.row.quantity)+"\n            "),a("q-popup-edit",{attrs:{title:"Update quantity",buttons:""},model:{value:e.row.quantity,callback:function(a){t.$set(e.row,"quantity",a)},expression:"props.row.quantity"}},[a("q-input",{attrs:{dense:"",autofocus:"",type:"number"},on:{change:function(a){return t.detect(e.row)}},model:{value:e.row.quantity,callback:function(a){t.$set(e.row,"quantity",a)},expression:"props.row.quantity"}})],1)],1),a("q-td",{key:"product",attrs:{props:e}},[a("span",{staticClass:"text-info text-bold"},[t._v(" "+t._s(e.row.product))]),a("br"),a("span",{},[t._v(" "+t._s(e.row.variant)+" ")])]),a("q-td",{key:"price",attrs:{props:e}},[a("div",{staticClass:"text-pre-wrap"},[t._v(t._s(e.row.price))])]),a("q-td",{key:"amount",attrs:{props:e}},[a("div",{staticClass:"text-pre-wrap"},[t._v(t._s(t.formatPrice(e.row.amount)))])])],1)]}}])})],1),a("center",[a("q-card-actions",{staticStyle:{width:"300px"},attrs:{vertical:""}},[a("q-btn",{staticClass:"q-mb-sm",attrs:{size:"20px",color:"info"},on:{click:function(e){t.purchased=!1}}},[t._v("Add New Product")]),a("q-btn",{attrs:{size:"20px",color:"secondary"},on:{click:function(e){return t.checkout()}}},[t._v("CHECKOUT")])],1)],1)],1)],1)])],1)],1)],1)},o=[],r=(a("c975"),a("a434"),a("5319"),a("c973")),i=a.n(r),n=a("f337"),c={name:"Scan",components:{StreamBarcodeReader:n["a"]},data(){return{columns:[{name:"quantity",required:!0,label:"QTY",align:"left",field:t=>t.quantity,format:t=>""+t,sortable:!0,style:"width: 5px"},{name:"product",align:"left",label:"Product",field:"product",sortable:!0},{name:"price",label:"Price",align:"left",field:"price",sortable:!0,style:"width: 20px"},{name:"amount",label:"Amount",align:"left",field:"amount",sortable:!0,style:"width: 20px"}],products:[],customer_no:null,purchased:!1,maximizedToggle:!0,result:null,add_details:!1,addDetail:!1,addPurchase:!1,product_name:null,company_name:null,id:null,variant:null,price:null,scanned:!1,product_id:null,camera:!0,myprice:"",msg:null,subtotal:0}},methods:{checkout(){this.$refs.customer_no.hasError||this.$axios.post("products/checkout",{shop_id:this.$q.sessionStorage.getItem("shop_id").toString(),customer_phone_number:this.customer_no,products:this.products},{headers:{Authorization:"Bearer "+this.$q.sessionStorage.getItem("token"),"Content-Type":"application/json"}}).then(t=>{this.msg="TRANSACTION COMPLETE ",console.log(t.data),this.showNotif(),this.purchased=!1}).catch(t=>{console.log(t.response)})},formatPrice(t){const e=(t/1).toFixed(2).replace(",",".");return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},add_to_list(){this.purchased=!0,this.products.push({product_id:this.id,quantity:1,product:this.product_name,variant:this.variant,price:this.price,amount:this.price}),this.scanned=!1,this.addPurchase=!1,this.get_total()},get_total(){for(var t in this.subtotal=0,this.products)this.subtotal+=parseInt(this.products[t].amount)},detect(t){console.log(t);const e=this.products.indexOf(t);t.quantity<1?(this.products.splice(e,1),this.get_total()):(t.amount=t.quantity*t.price,this.get_total())},showNotif(){this.$q.notify({message:this.msg,color:"info"})},add_to_store(){this.$refs.product_name.hasError||this.$refs.company_name.hasError||this.$refs.variant.hasError||this.$refs.price.hasError||(this.scanned=!1,this.addDetail=!1,this.$axios.post("products/create",{shop_id:this.$q.sessionStorage.getItem("shop_id").toString(),price:this.price,manufacturer_name:this.company_name,name:this.product_name,variant:this.variant,sku:this.result,ean:this.result},{headers:{Authorization:"Bearer "+this.$q.sessionStorage.getItem("token"),"Content-Type":"application/json"}}).then(t=>{this.msg="You have successfully added a new product! ",this.showNotif(),this.add_details=!1,this.camera=!0,console.log(t)}).catch(t=>{console.log(t.response)}))},prompt_user(){this.$q.dialog({title:"Add price for this product!",prompt:{model:"",isValid:t=>t.length>0,type:"number"},cancel:!0,persistent:!0}).onOk(t=>{this.$axios.post("/prices/create",{shop_id:this.$q.sessionStorage.getItem("shop_id").toString(),product_id:this.product_id,price:t},{headers:{Authorization:"Bearer "+this.$q.sessionStorage.getItem("token"),"Content-Type":"application/json"}}).then(t=>{this.msg="Price added successfully!",this.showNotif(),console.log(t)}).catch(t=>{console.log(t.response)}),this.camera=!0,this.scanned=!1}).onCancel(t=>{this.camera=!0,this.scanned=!1})},onDecode(t){var e=this;return i()((function*(){e.scanned=!0,e.result=t,e.company_name=null,e.product_name=null,e.variant=null,e.price=null,e.camera=!1,e.$axios.post("products/search/ean",{shop_id:e.$q.sessionStorage.getItem("shop_id").toString(),ean:t},{headers:{Authorization:"Bearer "+e.$q.sessionStorage.getItem("token"),"Content-Type":"application/json"}}).then(t=>{!0===t.data.results.price_available&&!0===t.data.results.product_available?(console.log(t.data),e.company_name=t.data.results.product.manufacturer_name,e.product_name=t.data.results.product.name,e.variant=t.data.results.product.variant,e.price=t.data.results.price.price,e.id=t.data.results.product.id,e.addPurchase=!0,e.addDetail=!1,e.camera=!0):!1===t.data.results.price_available&&!0===t.data.results.product_available&&(e.addDetail=!1,e.addPurchase=!1,e.product_id=t.data.results.product_id,e.prompt_user())}).catch(t=>{console.log(t.response),e.addDetail=!0,e.addPurchase=!1,e.camera=!0})}))()},onLoaded(t){return i()((function*(){}))()}},created(){}},l=c,d=a("2877"),u=a("4d5a"),p=a("09e3"),m=a("9989"),h=a("eb85"),_=a("9c40"),f=a("66e5"),q=a("4074"),x=a("0170"),b=a("24e8"),g=a("f09f"),v=a("a370"),y=a("27f9"),C=a("4b7e"),w=a("2c91"),k=a("eaac"),S=a("bd08"),P=a("db86"),$=a("42a1"),Q=a("eebe"),A=a.n(Q),D=Object(d["a"])(l,s,o,!1,null,null,null);e["default"]=D.exports;A()(D,"components",{QLayout:u["a"],QPageContainer:p["a"],QPage:m["a"],QSeparator:h["a"],QBtn:_["a"],QItem:f["a"],QItemSection:q["a"],QItemLabel:x["a"],QDialog:b["a"],QCard:g["a"],QCardSection:v["a"],QInput:y["a"],QCardActions:C["a"],QSpace:w["a"],QTable:k["a"],QTr:S["a"],QTd:P["a"],QPopupEdit:$["a"]})}}]);